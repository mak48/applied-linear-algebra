## Число обусловленности
$$
\chi = ||A||\cdot ||A^{-1}||
$$
Число обусловленности вычисляется как произведение норм матрицы $A$ и обратной матрицы $A^{-1}$, число обусловленности зависит от того, какая норма используется.

В numpy.linalg есть функция cond для вычисления числа обусловленности

https://numpy.org/doc/stable/reference/generated/numpy.linalg.cond.html

linalg.cond(x, p=None)

Функци cond вычисляет число обусловленности матрицы x, параметр p отвечает за норму, это эквивалент ord в linalg.norm, значения те же самые.
$$
\begin{matrix}
p &	norm\ for\ matrices\\
None &		Frobenius\ norm\\
‘fro’	 &	Frobenius\ norm\\
‘nuc’ &		nuclear\ norm\\
inf &		max(sum(abs(x),\ axis=1))\\
-inf &		min(sum(abs(x),\ axis=1))\\
0	 &	–\\
1	 &	max(sum(abs(x),\ axis=0))\\
-1 &		min(sum(abs(x),\ axis=0))\\
2	 &	2-norm\ (largest\ singular\ value)\\
-2 &		smallest\ singular\ value\\
other &		–
\end{matrix}
$$
## Число обусловленности в sympy
https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrices.MatrixBase.condition_number

condition_number()

В sympy реализовано минимально возможное число обусловленности, т.е. отношение максимального собственного значения к минимальному, это метод класса матриц Matrix.
## Задание 1.
Составить матрицу порядка 10, элементы которой находятся по формуле
$$
a_{ij} = (-1)^{ij}(i - j) - (i + j)^2.\qquad(1)
$$
Вывести на экран число обусловленности матриц $M_m$, состоящих из первых $m$ строк и столбцов матрицы $M_m$, в соответствии с матричными нормами $||\cdot||_1$, $||\cdot||_2$, $||\cdot||_\infty$ и $||\cdot||_F$,
 использовать numpy, а для $m = 3, 4, 5$ еще и sympy, $m$ от 3 до 10.

## Оценка погрешности СЛАУ
## Задание 2
1. Загрузить матрицу  $A$ и вектор правой части $b$ из файла sem_11_task_2.xlsx. Матрица находится на листе A2, вектор - на листе b2, поэтому в read_excel нужно указать sheet_name='A2' для считывания матрицы, столбец $b$ - аналогично.

2. Определить, вырождена ли матрица, найти ее ранг (np.linalg.matrix_rank).

3. По теореме Кронекера Капелли проверить совместность СЛАУ $AX = b$.

4. Найти число обусловленности матрицы  $A$.

5. С помощью np.linalg.solve найти решение $X^*$ СЛАУ $AX = b$.

Описать функцию для проведения вычислительного эксперимента, в котором

1. С помощью np.linalg.solve найти решение $X$ искаженной СЛАУ ($b_ɛ$ вместо $b$).

2. Точность решения оценить с помощью евклидовой нормы разности решений $||X - X^*||$, также использовать np.allclose.

3. Вычислить норму разности  векторов правых частей $||b_ɛ - b||$.

4. Проверить, что выполняется неравенство (2):
$$
\frac{\delta b}{\chi(A)}  \le \delta
X \le \chi(A)\delta b, \quad \chi(A) =  ||A||\,||A^{-1}||,\quad  \delta
X = \frac{|\Delta X|}{|X|}, \quad  \delta b = \frac{|\Delta b|}{|b|}.
\qquad(2)
$$

Аргументы функции матрица A, столбец  $b$, столбец искажений в виде случайных чисел типа float (от 0 до 1), умноженных на 0.001.

Функция возвращает решение СЛАУ, точность (в виде евклидовой нормы разности решений $||X - X^*||$),  норму разности векторов правых частей $||b_ɛ - b||$, выполнено ли неравенство (True\False).

Провести с помощью функции один эксперимент.

## Задание 3
Пусть параметр $r$ принимает значения 0.001, 0.005, 0.01, 0.02, 0.05.
Для матрицы Задания 2 внести искажения в каждый элемент   матрицы  $A$ в виде случайных чисел типа float (от $-r$ до $r$). Оценить сверху погрешность приближения обратной матрицы $A = \hat A + \varepsilon$, построить график зависимости наблюдаемой погрешности обратной матрицы $\delta  A^{-1}$ от $\delta \varepsilon$ в виде отдельных зеленых точек, соответствующим значениям $r$. В той же координатной плоскости построить график зависимости оценки погрешности обратной матрицы (правая часть неравенства) от $\delta \varepsilon$ в виде отдельных фиолетовых точек.
Для оценки использовать неравенство (3)
$$
 \delta  A^{-1} \le \frac{\chi(A)\delta \varepsilon}{1 - \chi(A)\delta \varepsilon}, \quad
  \delta  A^{-1} = \frac{||{\hat A}^{-1} - A^{-1}||}{||A^{-1}||},\quad
 \delta \varepsilon = \frac{||\varepsilon||}{||\hat A||}.
 \qquad(3)
$$

## Задание 4*
В СЛАУ из Задания 2 внести искажения в каждый элемент   матрицы  $A$ и вектора правой части $b$  в виде случайных чисел типа float (от 0 до 1), умноженных на 0.02.

Написать функцию для проведения серии экспериментов,

аргументы -  матрица  $A$, вектор правой части $b$, количество экспериментов,

функция возвращает долю экспериментов, в которых выполнено неравенство (4) (число от 0 до 1).

Провести 100 вычислительных экспериментов, в каждом из них проверить выполнение неравенства
$$
\frac{\delta b + \delta A}{\chi(A)}  \le \delta
X \le \chi(A)(\delta b + \delta A).\qquad(4)
$$
Все результаты эксперимента записать в файл experiment4.xlsx в таком формате:

На листе SLAE записать матрицу А и столбец b (т.е расширенную матрицу СЛАУ). На листе Solutions по столбцам записать точное решение $X^*$ и решения, полученные в результате каждого эксперимента.
На листе Result для каждого эксперимента в столбик записать:

1. евклидову нормы разности решений $||X_n - X^*||$,
2. спектральную норму разности матриц$||A_n - A||$,
3. евклидову нормы разности векторов правых частей $||b_n - b||$,
4. $\delta X$.


## Задание 5
Считать из файла 'sem_8_Example_1.xlsx' матрицу $A_1$.
Построить приближение ранга, равного 25\% размерности матрицы $A_1$ (в спектральной норме), найти норму разности матриц $A_1$ и ее приближения меньшего ранга.

# Задание 6.
Представить изображение в оттенках серого в виде матрицы, построить приближения меньшего ранга (10, 15, 25% от $k$ - минимального из чисел $m$ и $n$), вывести их изображения на экран.

## Задание 7*
Считать из файла 'sem_11_task_7.xlsx' матрицу $A_7$.
Построить матрицу $Ar_7$ - приближение меньшего ранга матрицы $A_7$ (в спектральной норме), такое что норма разности матриц $A_7$ и ее приближения меньшего ранга не превосходит 10\% от нормы матрицы $A_7$.

Записать на отдельные листы файла 'sem_11_task_7_ans.xlsx' компоненты svd разложения матрицы $A_7$  и матрицу $Ar_7$, являющуюся ее приближением меньшего ранга. Вывести на экран первые 10 наибольших сингулярных чисел матрицы $A_7$ и ранг $Ar_7$.

